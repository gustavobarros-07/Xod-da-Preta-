<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dados da Loja - Admin | Xodó da Preta</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    

    <!-- Xodo da Preta - Design System Unificado -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/xodo-core.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/xodo-admin.css') }}">

    <style>
        /* Placeholders mais visíveis */
        .form-control::placeholder {
            color: #6c757d !important;
            opacity: 1 !important;
        }

        /* Dica em destaque */
        .info-box {
            background-color: #fffbea !important;
            border-left: 4px solid var(--cor-dourada) !important;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.15);
        }

        .info-box strong {
            color: var(--cor-dourada) !important;
            font-size: 16px;
        }

        .info-box small {
            display: block;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .info-box small strong {
            color: var(--cor-dourada) !important;
        }

        /* Botão Salvar - Verde */
        .btn-save {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%) !important;
            color: white !important;
            border: none;
            padding: 12px 30px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
            transition: all 0.3s ease;
        }

        .btn-save:hover {
            background: linear-gradient(135deg, #218838 0%, #1e7e34 100%) !important;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.5);
        }

        /* Botão Cancelar - Vermelho */
        .d-flex.justify-content-end .btn-secondary {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%) !important;
            color: white !important;
            border: none;
            padding: 12px 30px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
            transition: all 0.3s ease;
        }

        .d-flex.justify-content-end .btn-secondary:hover {
            background: linear-gradient(135deg, #c82333 0%, #bd2130 100%) !important;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.5);
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h4>Xodó da Preta</h4>
            <small>Admin Panel</small>
        </div>
        
        <ul class="sidebar-menu">
            <li>
                <a href="{{ url_for('admin.dashboard') }}">
                    <i class="fas fa-th-large"></i> Dashboard
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.produtos') }}">
                    <i class="fas fa-box"></i> Produtos
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.subcategorias') }}">
                    <i class="fas fa-tags"></i> Subcategorias
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.conteudo_listar') }}">
                    <i class="fas fa-edit"></i> Gerenciar Conteúdo
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.configuracoes') }}" class="active">
                    <i class="fas fa-cog"></i> Dados da Loja
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.cupons') }}">
                    <i class="fas fa-ticket-alt"></i> Cupons
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.media_biblioteca') }}">
                    <i class="fas fa-images"></i> Biblioteca de Mídia
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.backup_painel') }}">
                    <i class="fas fa-hdd"></i> Backup
                </a>
            </li>
            <li>
                <a href="{{ url_for('home') }}" target="_blank">
                    <i class="fas fa-external-link-alt"></i> Ver Site
                </a>
            </li>
            <li>
                <a href="{{ url_for('admin.logout') }}" class="btn-logout" onclick="return confirm('Tem certeza que deseja sair do painel administrativo?');">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </a>
            </li>
        </ul>
    </div>
    
    <!-- Conteúdo Principal -->
    <div class="main-content">
        <!-- Header -->
        <div class="admin-header">
            <h1><i class="fas fa-cog me-2" style="color: var(--cor-dourada);"></i>Dados da Loja</h1>
            <p class="text-muted mb-0">Gerencie as informações da sua loja</p>
        </div>
        
        <!-- Mensagens Flash -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- Formulário de Configurações -->
        <div class="config-container">
            <div class="info-box">
                <i class="fas fa-info-circle"></i>
                <strong>Informação:</strong> Estas configurações aparecem no rodapé do site.
                <br>
                <small><i class="fas fa-lightbulb"></i> <strong>Dica:</strong> Campos deixados em branco não aparecerão no rodapé. Se não quiser exibir o email, por exemplo, basta deixá-lo vazio.</small>
            </div>

            <form method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <div class="mb-4">
                    <label for="loja_nome" class="form-label">
                        <i class="fas fa-store"></i> Nome da Loja
                    </label>
                    <input type="text" 
                           class="form-control" 
                           id="loja_nome" 
                           name="loja_nome" 
                           value="{{ configs.loja_nome }}"
                           placeholder="Ex: Xodó da Preta">
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <label for="loja_telefone" class="form-label">
                            <i class="fab fa-whatsapp"></i> Telefone / WhatsApp
                        </label>
                        <input type="text" 
                               class="form-control" 
                               id="loja_telefone" 
                               name="loja_telefone" 
                               value="{{ configs.loja_telefone }}"
                               placeholder="Ex: 55 11 99999-9999">
                        <small class="text-muted">Formato: Código do país + DDD + Número</small>
                    </div>
                    
                    <div class="col-md-6 mb-4">
                        <label for="loja_email" class="form-label">
                            <i class="fas fa-envelope"></i> Email de Contato
                        </label>
                        <input type="email"
                               class="form-control"
                               id="loja_email"
                               name="loja_email"
                               value="{{ configs.loja_email }}"
                               placeholder="contato@exemplo.com">
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <label for="loja_instagram" class="form-label">
                            <i class="fab fa-instagram"></i> Instagram
                        </label>
                        <input type="text"
                               class="form-control"
                               id="loja_instagram"
                               name="loja_instagram"
                               value="{{ configs.loja_instagram }}"
                               placeholder="@sualojaaqui">
                    </div>

                    <div class="col-md-6 mb-4">
                        <label for="loja_facebook" class="form-label">
                            <i class="fab fa-facebook-f"></i> Facebook
                        </label>
                        <input type="url"
                               class="form-control"
                               id="loja_facebook"
                               name="loja_facebook"
                               value="{{ configs.loja_facebook }}"
                               placeholder="https://www.facebook.com/sualojaaqui">
                    </div>

                    <div class="col-md-6 mb-4">
                        <label for="loja_endereco" class="form-label">
                            <i class="fas fa-map-marker-alt"></i> Endereço / Cidade
                        </label>
                        <input type="text"
                               class="form-control"
                               id="loja_endereco"
                               name="loja_endereco"
                               value="{{ configs.loja_endereco }}"
                               placeholder="São Paulo, SP">
                    </div>
                </div>

                <hr class="my-4">

                <h5 class="mb-3"><i class="fas fa-palette"></i> Personalização de Cores</h5>
                <p class="text-muted small mb-3">
                    <i class="fas fa-info-circle"></i> Personalize as cores do site. As cores padrão são baseadas na identidade visual da marca.
                </p>

                <div class="row">
                    <div class="col-md-4 mb-4">
                        <label for="cor_primaria" class="form-label">
                            <i class="fas fa-circle" id="icon-primaria"></i> Cor Primária (Dourado)
                        </label>
                        <input type="color"
                               class="form-control form-control-color"
                               id="cor_primaria"
                               name="cor_primaria"
                               value="{{ configs.cor_primaria }}"
                               title="Escolha a cor primária">
                        <small class="text-muted">Usada em botões, links e destaques</small>
                    </div>

                    <div class="col-md-4 mb-4">
                        <label for="cor_secundaria" class="form-label">
                            <i class="fas fa-circle" id="icon-secundaria"></i> Cor Secundária (Preto)
                        </label>
                        <input type="color"
                               class="form-control form-control-color"
                               id="cor_secundaria"
                               name="cor_secundaria"
                               value="{{ configs.cor_secundaria }}"
                               title="Escolha a cor secundária">
                        <small class="text-muted">Usada em textos e fundos escuros</small>
                    </div>

                    <div class="col-md-4 mb-4">
                        <label for="cor_destaque" class="form-label">
                            <i class="fas fa-circle" id="icon-destaque"></i> Cor de Destaque (Laranja)
                        </label>
                        <input type="color"
                               class="form-control form-control-color"
                               id="cor_destaque"
                               name="cor_destaque"
                               value="{{ configs.cor_destaque }}"
                               title="Escolha a cor de destaque">
                        <small class="text-muted">Usada em hover e elementos interativos</small>
                    </div>
                </div>

                <!-- Pré-visualização das Cores -->
                <div class="alert alert-info mb-3">
                    <h6><i class="fas fa-eye"></i> Pré-visualização</h6>
                    <p class="mb-2 small">Veja como as cores ficam em diferentes elementos:</p>

                    <div class="row g-2">
                        <div class="col-md-4">
                            <button type="button" class="btn w-100" id="preview-btn-primary" style="background-color: {{ configs.cor_primaria }}; border-color: {{ configs.cor_primaria }}; color: #000;">
                                <i class="fas fa-check"></i> Botão Primário
                            </button>
                        </div>
                        <div class="col-md-4">
                            <div class="p-2 text-center rounded" id="preview-bg-secondary" style="background-color: {{ configs.cor_secundaria }}; color: #fff;">
                                <small>Fundo Secundário</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="p-2 text-center border rounded" id="preview-hover-state">
                                <small>Hover: <span id="preview-text-destaque" style="color: {{ configs.cor_destaque }}; font-weight: bold;">Destaque</span></small>
                            </div>
                        </div>
                    </div>
                </div>

                <hr class="my-4">

                <h5 class="mb-3"><i class="fas fa-sliders-h"></i> Configurações de Exibição</h5>

                <div class="mb-4">
                    <div class="form-check form-switch">
                        <input class="form-check-input"
                               type="checkbox"
                               id="topbar_ativo"
                               name="topbar_ativo"
                               {% if configs.topbar_ativo %}checked{% endif %}>
                        <label class="form-check-label" for="topbar_ativo">
                            <i class="fas fa-bars"></i> <strong>Exibir Top Bar</strong>
                            <br>
                            <small class="text-muted">Barra preta fina no topo com telefone e redes sociais. Aparece apenas em telas ≥768px (tablets e desktops). IMPORTANTE: Certifique-se de que o navegador está maximizado para visualizar.</small>
                        </label>
                    </div>
                </div>

                <div class="d-flex justify-content-end gap-2 mt-4">
                    <button type="button" class="btn btn-secondary" onclick="window.location.reload();">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="submit" class="btn btn-save">
                        <i class="fas fa-save"></i> Salvar Configurações
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Preview -->
        <div class="config-container mt-4">
            <h4 class="mb-3"><i class="fas fa-eye"></i> Pré-visualização</h4>
            <p class="text-muted">Estas informações aparecerão assim no site (atualiza em tempo real):</p>

            <!-- Preview Top Bar -->
            <div id="preview-topbar" class="mb-4" style="{% if not configs.topbar_ativo %}display: none;{% endif %}">
                <h6 class="mb-2"><i class="fas fa-bars"></i> Top Bar</h6>
                <div style="background-color: #343a40; color: #f8f9fa; padding: 10px 20px; border-radius: 5px; font-size: 14px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div id="preview-topbar-phone">
                            <i class="fab fa-whatsapp"></i> <span>{{ configs.loja_telefone }}</span>
                        </div>
                        <div>
                            <span id="preview-topbar-facebook" {% if not configs.loja_facebook %}style="display: none;"{% endif %}>
                                <i class="fab fa-facebook-f"></i>
                            </span>
                            <span id="preview-topbar-instagram" {% if not configs.loja_instagram %}style="display: none;"{% endif %} class="ms-2">
                                <i class="fab fa-instagram"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview Footer -->
            <h6 class="mb-2"><i class="fas fa-shoe-prints"></i> Rodapé (como aparece no site)</h6>
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title" style="color: var(--cor-dourada); border-bottom: 1px solid #ddd; padding-bottom: 10px;" id="preview-nome">{{ configs.loja_nome }}</h5>

                            <!-- Ordem exata do footer real: Endereço, Telefone, Email -->
                            <p class="card-text mb-2" id="preview-endereco-container" {% if not configs.loja_endereco %}style="display: none;"{% endif %}>
                                <i class="fas fa-map-marker-alt"></i> <span id="preview-endereco">{{ configs.loja_endereco }}</span>
                            </p>
                            <p class="card-text mb-2" id="preview-telefone-container" {% if not configs.loja_telefone %}style="display: none;"{% endif %}>
                                <i class="fab fa-whatsapp"></i> <span id="preview-telefone">{{ configs.loja_telefone }}</span>
                            </p>
                            <p class="card-text mb-3" id="preview-email-container" {% if not configs.loja_email %}style="display: none;"{% endif %}>
                                <i class="fas fa-envelope"></i> <span id="preview-email">{{ configs.loja_email }}</span>
                            </p>

                            <!-- Redes sociais em seção separada (como no footer real) -->
                            <div style="border-top: 1px solid #ddd; padding-top: 10px; margin-top: 10px;">
                                <small class="text-muted d-block mb-2">Redes Sociais:</small>
                                <div>
                                    <span id="preview-facebook-container" {% if not configs.loja_facebook %}style="display: none;"{% endif %} class="me-2">
                                        <i class="fab fa-facebook-f" style="color: var(--cor-dourada);"></i>
                                    </span>
                                    <span id="preview-instagram-container" {% if not configs.loja_instagram %}style="display: none;"{% endif %}>
                                        <i class="fab fa-instagram" style="color: var(--cor-dourada);"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript para atualizar preview em tempo real -->
    <script>
    // Atualizar preview em tempo real
    function atualizarPreview() {
        // Nome da loja
        const nome = document.getElementById('loja_nome').value || 'Xodó da Preta';
        document.getElementById('preview-nome').textContent = nome;

        // Telefone
        const telefone = document.getElementById('loja_telefone').value;
        const telefoneContainer = document.getElementById('preview-telefone-container');
        const telefoneTopbar = document.getElementById('preview-topbar-phone').querySelector('span');
        if (telefone) {
            document.getElementById('preview-telefone').textContent = telefone;
            telefoneTopbar.textContent = telefone;
            telefoneContainer.style.display = 'block';
        } else {
            telefoneContainer.style.display = 'none';
        }

        // Email
        const email = document.getElementById('loja_email').value;
        const emailContainer = document.getElementById('preview-email-container');
        if (email) {
            document.getElementById('preview-email').textContent = email;
            emailContainer.style.display = 'block';
        } else {
            emailContainer.style.display = 'none';
        }

        // Instagram (apenas mostrar/ocultar ícone)
        const instagram = document.getElementById('loja_instagram').value;
        const instagramContainer = document.getElementById('preview-instagram-container');
        const instagramTopbar = document.getElementById('preview-topbar-instagram');
        if (instagram) {
            instagramContainer.style.display = 'inline';
            instagramTopbar.style.display = 'inline';
        } else {
            instagramContainer.style.display = 'none';
            instagramTopbar.style.display = 'none';
        }

        // Facebook (apenas mostrar/ocultar ícone)
        const facebook = document.getElementById('loja_facebook').value;
        const facebookContainer = document.getElementById('preview-facebook-container');
        const facebookTopbar = document.getElementById('preview-topbar-facebook');
        if (facebook) {
            facebookContainer.style.display = 'inline';
            facebookTopbar.style.display = 'inline';
        } else {
            facebookContainer.style.display = 'none';
            facebookTopbar.style.display = 'none';
        }

        // Endereço
        const endereco = document.getElementById('loja_endereco').value;
        const enderecoContainer = document.getElementById('preview-endereco-container');
        if (endereco) {
            document.getElementById('preview-endereco').textContent = endereco;
            enderecoContainer.style.display = 'block';
        } else {
            enderecoContainer.style.display = 'none';
        }

        // Top Bar ativo/inativo
        const topbarAtivo = document.getElementById('topbar_ativo').checked;
        const previewTopbar = document.getElementById('preview-topbar');
        if (topbarAtivo) {
            previewTopbar.style.display = 'block';
        } else {
            previewTopbar.style.display = 'none';
        }
    }

    // Adicionar listeners para todos os campos
    document.getElementById('loja_nome').addEventListener('input', atualizarPreview);
    document.getElementById('loja_telefone').addEventListener('input', atualizarPreview);
    document.getElementById('loja_email').addEventListener('input', atualizarPreview);
    document.getElementById('loja_instagram').addEventListener('input', atualizarPreview);
    document.getElementById('loja_facebook').addEventListener('input', atualizarPreview);
    document.getElementById('loja_endereco').addEventListener('input', atualizarPreview);
    document.getElementById('topbar_ativo').addEventListener('change', atualizarPreview);

    // ===== PRÉ-VISUALIZAÇÃO DINÂMICA DE CORES =====
    function atualizarPreviewCores() {
        const corPrimaria = document.getElementById('cor_primaria').value;
        const corSecundaria = document.getElementById('cor_secundaria').value;
        const corDestaque = document.getElementById('cor_destaque').value;

        // Atualizar ícones ao lado dos labels
        document.getElementById('icon-primaria').style.color = corPrimaria;
        document.getElementById('icon-secundaria').style.color = corSecundaria;
        document.getElementById('icon-destaque').style.color = corDestaque;

        // Atualizar preview do botão primário
        const btnPrimary = document.getElementById('preview-btn-primary');
        btnPrimary.style.backgroundColor = corPrimaria;
        btnPrimary.style.borderColor = corPrimaria;

        // Atualizar preview do fundo secundário
        const bgSecondary = document.getElementById('preview-bg-secondary');
        bgSecondary.style.backgroundColor = corSecundaria;

        // Atualizar preview do texto de destaque
        const textDestaque = document.getElementById('preview-text-destaque');
        textDestaque.style.color = corDestaque;

        // Atualizar preview do hover state
        const hoverState = document.getElementById('preview-hover-state');
        hoverState.style.borderColor = corDestaque;
    }

    // Adicionar listeners para os color pickers
    document.getElementById('cor_primaria').addEventListener('input', atualizarPreviewCores);
    document.getElementById('cor_secundaria').addEventListener('input', atualizarPreviewCores);
    document.getElementById('cor_destaque').addEventListener('input', atualizarPreviewCores);

    // Inicializar cores dos ícones ao carregar a página
    window.addEventListener('DOMContentLoaded', function() {
        atualizarPreviewCores();
    });
    </script>
</body>
</html>